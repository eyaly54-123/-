<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BioPro Ultra | הדור הבא</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700;900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Heebo', 'sans-serif'] },
                    animation: {
                        blob: "blob 7s infinite",
                        float: "float 6s ease-in-out infinite",
                    },
                    keyframes: {
                        blob: {
                            "0%": { transform: "translate(0px, 0px) scale(1)" },
                            "33%": { transform: "translate(30px, -50px) scale(1.1)" },
                            "66%": { transform: "translate(-20px, 20px) scale(0.9)" },
                            "100%": { transform: "translate(0px, 0px) scale(1)" },
                        },
                        float: {
                            "0%, 100%": { transform: "translateY(0)" },
                            "50%": { transform: "translateY(-20px)" },
                        }
                    },
                },
            },
        }
    </script>

    <style>
        /* כרום גלילה מותאם אישית */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #3730a3; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #4f46e5; }

        body { background-color: #020617; color: white; overflow-x: hidden; }

        /* אפקט זכוכית משופר */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        /* מסגרת טלפון ריאליסטית */
        .phone-mockup {
            width: 320px;
            height: 650px;
            border-radius: 55px;
            border: 8px solid #282828;
            position: relative;
            background: #000;
            box-shadow: 0 0 0 2px #444, 0 20px 50px -10px rgba(0,0,0,0.5);
            z-index: 10;
            transition: all 0.3s ease;
        }

        /* Dynamic Island */
        .dynamic-island {
            width: 100px;
            height: 28px;
            background: #000;
            position: absolute;
            top: 12px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 20px;
            z-index: 50;
            transition: all 0.3s ease;
        }
        .phone-mockup:hover .dynamic-island { width: 120px; }

        /* רקע אנימטיבי */
        .bg-gradient-animate {
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .input-group:focus-within label { color: #818cf8; }
        .input-group:focus-within input, .input-group:focus-within textarea { border-color: #818cf8; background: rgba(255,255,255,0.05); }
    </style>
</head>
<body class="min-h-screen selection:bg-indigo-500 selection:text-white">

    <div class="fixed inset-0 w-full h-full pointer-events-none z-0">
        <div class="absolute top-0 left-1/4 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob"></div>
        <div class="absolute top-0 right-1/4 w-96 h-96 bg-indigo-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000"></div>
        <div class="absolute -bottom-32 left-1/3 w-96 h-96 bg-pink-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000"></div>
    </div>

    <div id="authScreen" class="fixed inset-0 z-[100] flex flex-col items-center justify-center bg-[#020617] transition-all duration-700">
        <div class="relative group">
            <div class="absolute -inset-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 rounded-full blur opacity-25 group-hover:opacity-75 transition duration-1000 group-hover:duration-200"></div>
            <div class="relative px-10 py-8 bg-[#0f172a] ring-1 ring-white/10 rounded-3xl leading-none flex items-center justify-center flex-col space-y-6">
                <h1 class="text-6xl font-black bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-cyan-400">BioPro.</h1>
                <p class="text-slate-400">הכנס שם משתמש להתחלה</p>
                <div class="flex gap-2 w-full">
                    <span class="flex items-center text-slate-500 font-bold text-xl">@</span>
                    <input type="text" id="usernameInput" class="bg-transparent border-b-2 border-slate-700 outline-none text-xl font-bold w-full focus:border-indigo-500 transition-colors py-2 text-center" placeholder="yourname">
                </div>
                <button onclick="enterApp()" class="w-full bg-indigo-600 hover:bg-indigo-500 py-3 rounded-xl font-bold shadow-lg shadow-indigo-500/30 transition-all transform active:scale-95">צור כרטיס בחינם</button>
            </div>
        </div>
    </div>

    <main id="appContainer" class="relative z-10 max-w-[1600px] mx-auto p-4 lg:p-8 opacity-0 transition-opacity duration-1000 hidden">
        
        <header class="flex justify-between items-center mb-10 glass-panel p-4 rounded-2xl">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-indigo-600 rounded-full flex items-center justify-center font-bold text-lg">B</div>
                <div>
                    <h2 class="font-bold text-lg">עורך פרופיל</h2>
                    <p id="displayUsername" class="text-xs text-indigo-400 font-mono tracking-wider">@USER</p>
                </div>
            </div>
            <div class="flex gap-3">
                <button onclick="generateQR()" class="flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg text-sm transition border border-white/5">
                    <i class="fa-solid fa-qrcode"></i> QR Code
                </button>
                <button class="flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 rounded-lg text-sm font-bold shadow-lg shadow-indigo-500/20 transition">
                    <i class="fa-solid fa-share-nodes"></i> פרסם
                </button>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-16">
            
            <div class="lg:col-span-7 space-y-6">
                
                <div class="glass-panel p-8 rounded-3xl space-y-6">
                    <h3 class="flex items-center gap-2 text-lg font-bold text-slate-200">
                        <i class="fa-solid fa-user-pen text-indigo-400"></i> פרטים בסיסיים
                    </h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="input-group space-y-2">
                            <label class="text-xs uppercase font-bold text-slate-500 tracking-wider">שם מלא</label>
                            <input type="text" id="nameField" oninput="render()" placeholder="ישראל ישראלי" class="w-full bg-[#020617] border border-white/10 p-4 rounded-xl outline-none transition-all">
                        </div>
                        <div class="input-group space-y-2">
                            <label class="text-xs uppercase font-bold text-slate-500 tracking-wider">תמונת פרופיל (URL)</label>
                            <input type="text" id="imgField" oninput="render()" placeholder="https://..." class="w-full bg-[#020617] border border-white/10 p-4 rounded-xl outline-none transition-all">
                        </div>
                    </div>
                    
                    <div class="input-group space-y-2">
                        <label class="text-xs uppercase font-bold text-slate-500 tracking-wider">ביו / אודות</label>
                        <textarea id="bioField" oninput="render()" rows="3" placeholder="ספר בקצרה על העיסוק שלך..." class="w-full bg-[#020617] border border-white/10 p-4 rounded-xl outline-none transition-all resize-none"></textarea>
                    </div>
                </div>

                <div class="glass-panel p-8 rounded-3xl space-y-6">
                    <div class="flex justify-between items-center">
                        <h3 class="flex items-center gap-2 text-lg font-bold text-slate-200">
                            <i class="fa-solid fa-link text-indigo-400"></i> קישורים
                        </h3>
                        <button onclick="addLink()" class="text-xs bg-indigo-500/10 text-indigo-400 px-3 py-1 rounded-full border border-indigo-500/20 hover:bg-indigo-500/20 transition">+ הוסף חדש</button>
                    </div>
                    
                    <div id="linksContainer" class="space-y-4">
                        <div class="link-item group flex gap-4 bg-[#020617] p-4 rounded-2xl border border-white/5 hover:border-indigo-500/30 transition-all">
                            <div class="flex flex-col gap-1 flex-1">
                                <input type="text" class="link-title bg-transparent font-bold outline-none placeholder-slate-600" placeholder="כותרת (למשל: אינסטגרם)" oninput="render()">
                                <input type="text" class="link-url text-sm text-indigo-400 bg-transparent outline-none placeholder-indigo-900/50" placeholder="https://..." oninput="render()">
                            </div>
                            <button onclick="this.closest('.link-item').remove(); render()" class="text-slate-600 hover:text-red-400 transition"><i class="fa-solid fa-trash"></i></button>
                        </div>
                    </div>
                </div>

                <div class="glass-panel p-8 rounded-3xl space-y-6">
                    <h3 class="flex items-center gap-2 text-lg font-bold text-slate-200">
                        <i class="fa-solid fa-palette text-indigo-400"></i> עיצוב וצבעים
                    </h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div onclick="setTheme('dark')" class="cursor-pointer h-24 rounded-xl bg-slate-900 border-2 border-indigo-500 flex items-center justify-center relative overflow-hidden group">
                            <span class="z-10 font-bold text-sm">Dark Pro</span>
                        </div>
                        <div onclick="setTheme('sunset')" class="cursor-pointer h-24 rounded-xl bg-gradient-to-br from-orange-500 to-purple-600 border border-transparent hover:scale-105 transition flex items-center justify-center">
                            <span class="font-bold text-sm text-white drop-shadow-md">Sunset</span>
                        </div>
                        <div onclick="setTheme('ocean')" class="cursor-pointer h-24 rounded-xl bg-gradient-to-br from-cyan-500 to-blue-600 border border-transparent hover:scale-105 transition flex items-center justify-center">
                            <span class="font-bold text-sm text-white drop-shadow-md">Ocean</span>
                        </div>
                        <div onclick="setTheme('forest')" class="cursor-pointer h-24 rounded-xl bg-[#0f2e1a] border border-green-800 hover:scale-105 transition flex items-center justify-center">
                            <span class="font-bold text-sm text-green-400">Forest</span>
                        </div>
                    </div>
                </div>

            </div>

            <div class="lg:col-span-5 flex flex-col items-center">
                <div class="sticky top-10">
                    <div class="text-center mb-6">
                        <h4 class="text-sm font-bold text-slate-500 uppercase tracking-widest">Live Preview</h4>
                    </div>
                    
                    <div class="phone-mockup shadow-2xl overflow-hidden">
                        <div class="dynamic-island"></div>
                        
                        <div id="phoneScreen" class="w-full h-full overflow-y-auto overflow-x-hidden relative scrollbar-hide">
                            <div id="phoneBg" class="absolute inset-0 z-0 bg-slate-900 transition-all duration-500"></div>
                            
                            <div class="relative z-10 flex flex-col items-center pt-20 px-6 pb-10 min-h-full">
                                
                                <div class="relative">
                                    <div class="absolute -inset-1 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full blur opacity-75"></div>
                                    <img id="prevImg" src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png" class="relative w-24 h-24 rounded-full object-cover border-4 border-black shadow-xl" alt="Profile">
                                </div>

                                <h2 id="prevName" class="mt-4 text-xl font-bold text-center text-white">Your Name</h2>
                                <p id="prevBio" class="mt-2 text-xs text-center text-white/70 font-light leading-relaxed max-w-[250px]">Bio description will appear here...</p>

                                <div id="prevLinks" class="w-full mt-8 space-y-3">
                                    </div>

                                <div class="mt-auto pt-8">
                                    <p class="text-[10px] uppercase tracking-widest opacity-40 font-bold">BioPro</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="qrModal" class="fixed inset-0 z-[60] flex items-center justify-center bg-black/80 backdrop-blur-sm hidden opacity-0 transition-opacity duration-300">
        <div class="bg-white p-8 rounded-3xl text-center space-y-4 max-w-sm w-full mx-4">
            <h3 class="text-2xl font-bold text-slate-800">הסריקה שלך מוכנה</h3>
            <div class="bg-slate-100 p-4 rounded-xl inline-block">
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=BioProExample" alt="QR" class="mix-blend-multiply">
            </div>
            <p class="text-slate-500 text-sm">סרוק כדי לצפות בפרופיל במובייל</p>
            <button onclick="closeQR()" class="w-full py-3 bg-slate-900 text-white rounded-xl font-bold">סגור</button>
        </div>
    </div>

   <script>
        // --- לוגיקה לשמירה וטעינה מה-URL ---
        
        // פונקציה שמקודדת את המידע לתוך ה-URL
        function generateShareableLink() {
            const data = {
                u: document.getElementById('usernameInput').value || 'User',
                n: document.getElementById('nameField').value,
                b: document.getElementById('bioField').value,
                i: document.getElementById('imgField').value,
                t: currentTheme,
                l: [] // Links array
            };

            document.querySelectorAll('.link-item').forEach(item => {
                const title = item.querySelector('.link-title').value;
                const url = item.querySelector('.link-url').value;
                if (title && url) data.l.push({ t: title, u: url });
            });

            // המרה ל-Base64 כדי שהלינק יראה (יחסית) נקי
            // שימוש ב-encodeURIComponent כדי לתמוך בעברית
            const jsonString = JSON.stringify(data);
            const encodedData = btoa(unescape(encodeURIComponent(jsonString)));
            
            const baseUrl = window.location.href.split('?')[0];
            const finalUrl = `${baseUrl}?data=${encodedData}`;

            // העתקה ללוח
            navigator.clipboard.writeText(finalUrl).then(() => {
                alert('הלינק הועתק! שלח אותו לחברים או פתח אותו בטאב חדש כדי לראות את התוצאה.');
            });
        }

        // פונקציה שטוענת מידע מה-URL (אם קיים)
        function loadFromURL() {
            const params = new URLSearchParams(window.location.search);
            const encodedData = params.get('data');

            if (encodedData) {
                try {
                    // פענוח המידע
                    const jsonString = decodeURIComponent(escape(atob(encodedData)));
                    const data = JSON.parse(jsonString);

                    // מצב צפייה בלבד (מסתיר את העורך)
                    document.getElementById('authScreen').style.display = 'none';
                    document.getElementById('appContainer').classList.remove('hidden');
                    document.getElementById('appContainer').classList.remove('opacity-0');
                    
                    // הסתרת פאנל העריכה והשארת רק הטלפון (למי שפותח את הלינק)
                    if(window.innerWidth < 1024) { 
                        // במובייל - מראה רק את התוצאה
                        document.querySelector('.lg\\:col-span-7').style.display = 'none';
                        document.querySelector('.lg\\:col-span-5').classList.remove('lg:col-span-5');
                        document.querySelector('.lg\\:col-span-5').classList.add('w-full');
                    }

                    // מילוי הנתונים
                    document.getElementById('displayUsername').innerText = '@' + data.u;
                    document.getElementById('nameField').value = data.n || '';
                    document.getElementById('bioField').value = data.b || '';
                    document.getElementById('imgField').value = data.i || '';
                    
                    // שחזור לינקים
                    const linksContainer = document.getElementById('linksContainer');
                    linksContainer.innerHTML = ''; // ניקוי
                    data.l.forEach(link => {
                        addLink(link.t, link.u);
                    });

                    setTheme(data.t || 'dark');
                    render(); // רענון תצוגה

                } catch (e) {
                    console.error('Error parsing URL data', e);
                }
            }
        }

        // --- סוף לוגיקה חדשה ---

        let currentTheme = 'dark';
        const themes = {
            dark: { bg: '#0f172a', btn: 'bg-white/10 hover:bg-white/20 border-white/5', text: 'text-white' },
            sunset: { bg: 'linear-gradient(180deg, #4c1d95 0%, #be185d 100%)', btn: 'bg-black/20 hover:bg-black/30 border-white/10', text: 'text-white' },
            ocean: { bg: 'linear-gradient(180deg, #155e75 0%, #0891b2 100%)', btn: 'bg-white/20 backdrop-blur-md border-white/20', text: 'text-white' },
            forest: { bg: '#052e16', btn: 'bg-[#14532d] border-green-800 text-green-100', text: 'text-green-50' }
        };

        function enterApp() {
            const user = document.getElementById('usernameInput').value;
            if(!user) return alert('נא להזין שם משתמש');
            document.getElementById('displayUsername').innerText = '@' + user;
            const auth = document.getElementById('authScreen');
            auth.style.opacity = '0';
            setTimeout(() => {
                auth.style.display = 'none';
                const app = document.getElementById('appContainer');
                app.classList.remove('hidden');
                setTimeout(() => app.classList.remove('opacity-0'), 50);
            }, 700);
        }

        // עדכון הפונקציה לקבלת פרמטרים
        function addLink(titleVal = '', urlVal = '') {
            const container = document.getElementById('linksContainer');
            const div = document.createElement('div');
            div.className = 'link-item group flex gap-4 bg-[#020617] p-4 rounded-2xl border border-white/5 hover:border-indigo-500/30 transition-all animation-fade-in';
            div.innerHTML = `
                <div class="flex flex-col gap-1 flex-1">
                    <input type="text" class="link-title bg-transparent font-bold outline-none placeholder-slate-600" value="${titleVal}" placeholder="כותרת" oninput="render()">
                    <input type="text" class="link-url text-sm text-indigo-400 bg-transparent outline-none placeholder-indigo-900/50" value="${urlVal}" placeholder="URL" oninput="render()">
                </div>
                <button onclick="this.closest('.link-item').remove(); render()" class="text-slate-600 hover:text-red-400 transition"><i class="fa-solid fa-trash"></i></button>
            `;
            container.appendChild(div);
            render();
        }

        function getIcon(url) {
            url = url.toLowerCase();
            if(url.includes('instagram')) return '<i class="fa-brands fa-instagram text-xl"></i>';
            if(url.includes('twitter') || url.includes('x.com')) return '<i class="fa-brands fa-x-twitter text-xl"></i>';
            if(url.includes('linkedin')) return '<i class="fa-brands fa-linkedin text-xl"></i>';
            if(url.includes('facebook')) return '<i class="fa-brands fa-facebook text-xl"></i>';
            if(url.includes('tiktok')) return '<i class="fa-brands fa-tiktok text-xl"></i>';
            if(url.includes('youtube')) return '<i class="fa-brands fa-youtube text-xl"></i>';
            if(url.includes('github')) return '<i class="fa-brands fa-github text-xl"></i>';
            if(url.includes('whatsapp')) return '<i class="fa-brands fa-whatsapp text-xl"></i>';
            if(url.includes('waze')) return '<i class="fa-brands fa-waze text-xl"></i>';
            if(url.includes('mailto')) return '<i class="fa-solid fa-envelope text-xl"></i>';
            if(url.includes('tel')) return '<i class="fa-solid fa-phone text-xl"></i>';
            return '<i class="fa-solid fa-link text-xl"></i>';
        }

        function render() {
            const name = document.getElementById('nameField').value;
            const bio = document.getElementById('bioField').value;
            const img = document.getElementById('imgField').value;

            document.getElementById('prevName').innerText = name || "Your Name";
            document.getElementById('prevBio').innerText = bio || "Bio description...";
            if(img) document.getElementById('prevImg').src = img;

            const linksDiv = document.getElementById('prevLinks');
            linksDiv.innerHTML = '';
            
            const linkItems = document.querySelectorAll('.link-item');
            const themeObj = themes[currentTheme];

            linkItems.forEach(item => {
                const title = item.querySelector('.link-title').value;
                const url = item.querySelector('.link-url').value;

                if(title) {
                    const icon = getIcon(url || '');
                    const btn = document.createElement('a');
                    // אם זה לינק רגיל, הוא יפתח בחלון חדש
                    btn.href = url || '#';
                    btn.target = "_blank";
                    btn.className = `flex items-center justify-between w-full p-4 rounded-xl border backdrop-blur-sm shadow-lg transition-all hover:scale-[1.02] active:scale-95 ${themeObj.btn} ${themeObj.text}`;
                    btn.innerHTML = `
                        <div class="flex items-center gap-3">
                            <span class="opacity-70">${icon}</span>
                            <span class="font-bold text-sm">${title}</span>
                        </div>
                        <i class="fa-solid fa-chevron-left opacity-50 text-xs"></i>
                    `;
                    linksDiv.appendChild(btn);
                }
            });
        }

        function setTheme(themeName) {
            currentTheme = themeName;
            const bgDiv = document.getElementById('phoneBg');
            bgDiv.style.background = themes[themeName].bg;
            render();
        }

        // חיבור כפתור הפרסום לפונקציה החדשה
        document.querySelector('.fa-share-nodes').closest('button').onclick = generateShareableLink;
        
        // טעינה ראשונית - בדיקה אם יש מידע ב-URL
        window.addEventListener('load', loadFromURL);

        function generateQR() {
            const modal = document.getElementById('qrModal');
            modal.classList.remove('hidden');
            setTimeout(() => modal.classList.remove('opacity-0'), 10);
        }

        function closeQR() {
            const modal = document.getElementById('qrModal');
            modal.classList.add('opacity-0');
            setTimeout(() => modal.classList.add('hidden'), 300);
        }
    </script>
</body>
</html>
